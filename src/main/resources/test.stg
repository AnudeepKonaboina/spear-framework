test(data)::=<<
$data:test1()$
>>

test1(data)::=<<
$data$
select $data:{row | cast ($row.source_col$ as $row.target_datatype$)as $data.target_col$ };separator=","$
>>